rules:
  - id: tar-insecure-flags
    message: Found `tar` command using insecure flags for $PATH
    languages:
      - dockerfile
      - bash
    severity: WARNING
    metadata:
      category: security
      subcategory:
        - audit
      technology:
        - shell
      cwe: "CWE-73: External Control of File Name or Path"
      confidence: MEDIUM
      likelihood: MEDIUM
      impact: HIGH
      references:
        - https://man7.org/linux/man-pages/man1/tar.1.html
      license: AGPL-3.0 license
      vulnerability_class:
        - Path Traversal
    pattern-either:
      - pattern: tar $...OPTIONS -P $PATH
      - pattern: tar $...OPTIONS --absolute-paths $PATH
      - pattern: tar $...OPTIONS --absolute-names $PATH
      - pattern: tar $...OPTIONS --passphrase $PHRASE
